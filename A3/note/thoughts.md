# Thought.md

做A3的思路

1. 该任务并不属于data-flow analysis，而是在Live Variable analysis和Constant Propagation analysis这两个data-flow analysis的基础上，对CFG进行遍历
2. 在遍历的过程中，由于已经有了每个Node(这里每个Node都是statement)的分析结果
    - 例如无用赋值：变量是否使用，如果某个变量的赋值语句，但是这个变量在后续没有使用，那么这个语句就可以删除
    - 不可达代码：这个是影响遍历过程，根据常量传播的结果，遍历可能到达的分支，标记对应的语句，然后返回没有标记的语句

## 遍历的思路

1. 根据常量传播遍历，不可到达的就是死代码
2. 对于可以到达的stmt，如果其是Assign语句，那么也需要判断其定义是否有用

那么就进行一次判断

一开始将所有的stmt放入到一个集合当中

1. 首先进行遍历，根据常量传播的方式进行遍历，这里可以采用深度或者广度遍历，遍历的过程中要避免重复
2. 然后处理当前的语句，如果该语句是AssignStmt，并且右侧的表达式没有副作用(利用给出的函数判断)，并且在INFact中没有lValue，那么就可以删除

对于一个语句

1. 首先判断其是不是赋值语句
2. 然后判断其左侧有没有Exp，如果没有，说明不是
3. 然后判断其左侧的Exp是不是Var，说明不是
4. 如果是Var，那么就看在INFact中是否有，如果有，说明不是
5. 如果没有，还需要判断右侧是否有副作用

然后需要遍历后续的节点，这个需要根据Constant Propagation的步骤传播

- 如果不是if分支，那么就返回全部的情况
- 如果是if分支，那么就返回可以到达的分支
- 如果是switch，那么就返回可以到达的case，一般仅仅只有一个